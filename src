const fs = require('fs');
const { Client, Collection, GatewayIntentBits } = require('discord.js');
require('dotenv').config();

const client = new Client({
  intents: [GatewayIntentBits.Guilds, GatewayIntentBits.GuildMessages, GatewayIntentBits.MessageContent],
});
client.commands = new Collection();
client.snipes = new Collection();

// Load commands
for (const file of fs.readdirSync('./src/commands').filter(f => f.endsWith('.js'))) {
  const cmd = require(`./src/commands/${file}`);
  client.commands.set(cmd.data.name, cmd);
}

// Load subcommands
for (const file of fs.readdirSync('./src/commands/fun').filter(f => f.endsWith('.js'))) {
  const cmd = require(`./src/commands/fun/${file}`);
  client.commands.set(cmd.data.name, cmd);
}

// Load events
for (const file of fs.readdirSync('./src/events').filter(f => f.endsWith('.js'))) {
  const evt = require(`./src/events/${file}`);
  client[evt.once ? 'once' : 'on'](evt.name, (...args) => evt.execute(...args, client));
}

client.login(process.env.TOKEN);
